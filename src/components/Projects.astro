---
import Flutter from "../components/icons/Flutter.astro";
import Dart from "../components/icons/Dart.astro";
import Firebase from "../components/icons/Firebase.astro";
import HTML from "../components/icons/HTML.astro";
import CSS from "../components/icons/CSS.astro";
import JavaScript from "../components/icons/JavaScript.astro";
import Python from "../components/icons/Python.astro";
import Django from "../components/icons/Django.astro";
import MySQL from "../components/icons/MySQL.astro";
import Arduino from "../components/icons/Arduino.astro";
import Cpp from "../components/icons/Cpp.astro";
import Docker from "../components/icons/Docker.astro";
import Kubernetes from "../components/icons/Kubernetes.astro";
import GCP from "../components/icons/GCP.astro";
import React from "../components/icons/React.astro";
import Flask from "../components/icons/Flask.astro";

import Project from "./Project.astro";

const TAGS = {
    FLASK: {
        name: "Flask",
        classList: "bg-blue-500 text-white",
        icon: Flask
    },
    REACT: {
        name: "React",
        classList: "bg-blue-500 text-white",
        icon: React
    },
    FLUTTER: {
        name: "Flutter",
        classList: "bg-blue-500 text-white",
        icon: Flutter,
    },
    DART: {
        name: "Dart",
        classList: "bg-blue-500 text-white",
        icon: Dart,
    },
    FIREBASE: {
        name: "Firebase",
        classList: "bg-yellow-800 text-white",
        icon: Firebase,
    },
    HTML: {
        name: "HTML",
        classList: "bg-red-500 text-white",
        icon: HTML,
    },
    CSS: {
        name: "CSS",
        classList: "bg-blue-500 text-white",
        icon: CSS,
    },
    JAVASCRIPT: {
        name: "JavaScript",
        classList: "bg-yellow-800 text-white",
        icon: JavaScript,
    },
    PYTHON: {
        name: "Python",
        classList: "bg-blue-500 text-white",
        icon: Python,
    },
    DJANGO: {
        name: "Django",
        classList: "bg-green-800 text-white",
        icon: Django,
    },
    MYSQL: {
        name: "MySQL",
        classList: "bg-blue-400 text-white ",
        icon: MySQL,
    },
    ARDUINO: {
        name: "Arduino",
        classList: "bg-blue-300 text-white",
        icon: Arduino,
    },
    CPP: {
        name: "C++",
        classList: "bg-blue-500 text-white",
        icon: Cpp,
    },
    DOCKER: {
        name: "Docker",
        classList: "bg-blue-600 text-white",
        icon: Docker,
    },
    KUBERNETES: {
        name: "Kubernetes",
        classList: "bg-blue-700 text-white",
        icon: Kubernetes,
    },
    GCP: {
        name: "GCP",
        classList: "bg-blue-500 text-white",
        icon: GCP,
    },
};

import { translations, type Language } from "../i18n/translations";
import { DEFAULT_LANGUAGE } from "../i18n/utils";

const lang: Language = DEFAULT_LANGUAGE;
const t = translations[lang];

const PROJECTS = [
    {
        key: "runpath",
        title: t.projects.items.runpath.title,
        description: t.projects.items.runpath.description,
        image: "/projects/runpath.webp",
        tags: [TAGS.DOCKER, TAGS.KUBERNETES, TAGS.GCP, TAGS.PYTHON],
        link: "#",
        caseStudy: true,
    },
    {
        key: "agroconecta",
        title: t.projects.items.agroconecta.title,
        description: t.projects.items.agroconecta.description,
        image: "/projects/agroconecta.webp",
        tags: [TAGS.PYTHON, TAGS.REACT, TAGS.FLASK],
        link: "https://medium.com/p/1a7784baa38c",
        caseStudy: true
    },
    {
        key: "unchaza",
        title: t.projects.items.unchaza.title,
        description: t.projects.items.unchaza.description,
        image: "/projects/unchaza.webp",
        tags: [TAGS.FLUTTER, TAGS.DART],
        github: "https://github.com/SamuelVar05/Proyecto_IngeSoft",
    },
    {
        key: "studybuddy",
        title: t.projects.items.studybuddy.title,
        description: t.projects.items.studybuddy.description,
        image: "/projects/study-buddy.webp",
        tags: [TAGS.FLUTTER, TAGS.DART, TAGS.FIREBASE],
        github: "https://github.com/SamuelVar05/StudyBuddy",
    },
    {
        key: "evaluacion",
        title: t.projects.items.title,
        description: t.projects.items.evaluacion.description,
        image: "/projects/evaluacion-docente.webp",
        tags: [
            TAGS.HTML,
            TAGS.CSS,
            TAGS.JAVASCRIPT,
            TAGS.PYTHON,
            TAGS.DJANGO,
            TAGS.MYSQL,
        ],
        github: "https://github.com/SamuelVar05/ProyectoBases",
    },
    {
        key: "colorpicker",
        title: t.projects.items.colorpicker.title,
        description: t.projects.items.colorpicker.description,
        image: "/projects/color-picker.webp",
        tags: [TAGS.FLUTTER, TAGS.DART, TAGS.ARDUINO, TAGS.CPP],
        github: "https://github.com/SamuelVar05/color_picker",
    },
];


// Get the className and id from the Astro props
const { class: className, id } = Astro.props;
---

<div class=`${className} flex flex-col gap-y-16 md:gap-y-20` id={id}>
    {PROJECTS.map((project, index) => (
        <div class={`project-item`} data-project-key={project.key}>
            <Project project={project} />
        </div>

    ))}
</div>
<script>
    import { translations } from "../i18n/translations";

    function getLanguage() {
        if (typeof window === "undefined") return "en";
        const stored = localStorage.getItem("language");
        return stored === "en" || stored === "es" ? stored : "en";
    }

    function updateProjectTranslations() {
        const lang = getLanguage();
        const t = translations[lang];

        document.querySelectorAll(".project-item").forEach(container => {
            const key = (container as HTMLElement).dataset.projectKey;
            const article = container.querySelector("article");

            if (!key || !article) return;

            const project = t.projects.items[key];
            if (!project) return;

            const title = article.querySelector("[data-i18n-project-title]");
            const description = article.querySelector("[data-i18n-project-description]");
            const featured = article.querySelector("[data-i18n-project-featured]");
            const caseStudyBtn = article.querySelector("span[data-i18n-case-study]");

            if (title) title.textContent = project.title;
            if (description) description.textContent = project.description;
            if (featured) featured.textContent = t.projects.featured;
            if (caseStudyBtn) caseStudyBtn.textContent = t.projects.caseStudy;
        });
    }

    document.addEventListener("DOMContentLoaded", updateProjectTranslations);
    document.addEventListener("astro:page-load", updateProjectTranslations);
    document.addEventListener("languagechange", updateProjectTranslations);
</script>
